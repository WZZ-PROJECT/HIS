{"remainingRequest":"F:\\XM\\his-web\\node_modules\\thread-loader\\dist\\cjs.js!F:\\XM\\his-web\\node_modules\\babel-loader\\lib\\index.js!F:\\XM\\his-web\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!F:\\XM\\his-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\XM\\his-web\\src\\views\\outpatient\\workstation\\record.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\XM\\his-web\\src\\views\\outpatient\\workstation\\record.vue","mtime":1602056307738},{"path":"F:\\XM\\his-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1600936410370},{"path":"F:\\XM\\his-web\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1600936436646},{"path":"F:\\XM\\his-web\\node_modules\\babel-loader\\lib\\index.js","mtime":1600936408645},{"path":"F:\\XM\\his-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1600936410370},{"path":"F:\\XM\\his-web\\node_modules\\vue-loader\\lib\\index.js","mtime":1600936442292}],"contextDependencies":[],"result":["import \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"F:/XM/his-web/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.function.name\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { getDmsDislist, parseList } from '@/api/diagnosis';\nimport { submitPriliminaryDise as _submitPriliminaryDise, selectEndCaseHistoryByReg as _selectEndCaseHistoryByReg } from '@/api/outpatient/dmscase';\nimport { getAllStaffModel as _getAllStaffModel } from '@/api/outpatient/dmscasemodel';\nimport Pagination from '@/components/Pagination';\nimport { selectByType, addfre, delfre } from '@/api/outpatient/frequentuse';\nimport { parseTime, deepClone } from '@/utils';\nimport { saveCasePage as _saveCasePage, getCasePage as _getCasePage } from '@/api/outpatient/save';\nexport default {\n  props: ['patient'],\n  name: 'Record',\n  components: {\n    Pagination: Pagination\n  },\n  data: function data() {\n    return {\n      history: [],\n      historyitem: {},\n      pickerOptions: {\n        disabledDate: function disabledDate(time) {\n          return time.getTime() > Date.now();\n        },\n        shortcuts: [{\n          text: '今天',\n          onClick: function onClick(picker) {\n            picker.$emit('pick', new Date());\n          }\n        }, {\n          text: '昨天',\n          onClick: function onClick(picker) {\n            var date = new Date();\n            date.setTime(date.getTime() - 3600 * 1000 * 24);\n            picker.$emit('pick', date);\n          }\n        }, {\n          text: '一周前',\n          onClick: function onClick(picker) {\n            var date = new Date();\n            date.setTime(date.getTime() - 3600 * 1000 * 24 * 7);\n            picker.$emit('pick', date);\n          }\n        }]\n      },\n      dialogTableVisible: false,\n      activeName: 'first',\n      isclose: false,\n      record: [],\n      medicineDiseIdList: [],\n      //常用诊断\n      priliminaryDise: {\n        chiefComplaint: '',\n        //主述\n        historyOfPresentIllness: '',\n        //现病史\n        historyOfTreatment: '',\n        //现治疗情况\n        pastHistory: '',\n        //既往史\n        allergies: '',\n        //过敏史\n        healthCheckup: '',\n        //体格检查\n        registrationId: '',\n        //\n        priliminaryDiseStrList: '',\n        priliminaryDiseIdList: '',\n        startDate: '',\n        name: '',\n        gender: '',\n        ageStr: ''\n      },\n      mainwidth: \"80%\",\n      activeNames: ['1'],\n      data2: [{\n        date: '0001',\n        name: '王小虎1',\n        address: '38岁'\n      }, {\n        date: '0002',\n        name: '王小虎2',\n        address: '39岁'\n      }],\n      total: 0,\n      disQuery: {\n        catId: '',\n        code: '',\n        name: '',\n        icd: '',\n        status: '',\n        pageSize: 8,\n        pageNum: 1\n      },\n      models: [],\n      model: {},\n      disList: []\n    };\n  },\n  created: function created() {\n    this.getmedicineDiseIdList();\n    this.getAllStaffModel();\n  },\n  watch: {\n    'patient': function patient(newVal, oldVal) {\n      this.patient = newVal;\n      this.selectEndCaseHistoryByReg();\n      this.getCasePage();\n    }\n  },\n  methods: {\n    addmodel: function addmodel(val) {\n      var _this = this;\n\n      this.$confirm('是否加载病历模板 ' + val.name + ' ?', '加载病历模板', {\n        confirmButtonText: '确认',\n        cancelButtonText: '取消',\n        type: 'success'\n      }).then(function () {\n        _this.priliminaryDise = deepClone(val);\n        var diss = '';\n\n        _this.priliminaryDise.priliminaryDiseIdList.forEach(function (item) {\n          diss += item + ',';\n        });\n\n        diss = diss.substr(0, diss.length - 1);\n        parseList(diss).then(function (res) {\n          _this.record = res.data;\n        });\n      });\n    },\n    selectmodel: function selectmodel(val) {\n      this.model = val;\n    },\n    getAllStaffModel: function getAllStaffModel() {\n      var _this2 = this;\n\n      _getAllStaffModel(this.$store.getters.id).then(function (res) {\n        _this2.models = res.data.staffList;\n\n        _this2.models.forEach(function (item) {\n          item.dis = '';\n          item.priliminaryDiseStrList.forEach(function (dis) {\n            item.dis += dis + ',';\n          });\n          item.dis = item.dis.substr(0, item.dis.length - 1);\n        });\n      });\n    },\n    saveCasePage: function saveCasePage() {\n      var _this3 = this;\n\n      var data = this.priliminaryDise;\n      data.registrationId = this.patient.registrationId;\n\n      _saveCasePage(this.priliminaryDise).then(function (res) {\n        _this3.$notify({\n          title: '成功',\n          message: '已暂存病历首页',\n          type: 'success',\n          duration: 2000\n        });\n      });\n    },\n    getCasePage: function getCasePage() {\n      var _this4 = this;\n\n      _getCasePage(this.patient.registrationId).then(function (res) {\n        if (res.data !== null) {\n          _this4.priliminaryDise = res.data;\n\n          _this4.$notify({\n            title: '成功',\n            message: '已加载暂存病历首页',\n            type: 'success',\n            duration: 2000\n          });\n        }\n      });\n    },\n    selecthistory: function selecthistory(val) {\n      this.historyitem = val;\n    },\n    selectEndCaseHistoryByReg: function selectEndCaseHistoryByReg() {\n      var _this5 = this;\n\n      _selectEndCaseHistoryByReg(this.patient.registrationId).then(function (res) {\n        _this5.history = res.data.dmsCaseHistoryList;\n\n        _this5.history.forEach(function (item) {\n          item.createTime = parseTime(item.createTime);\n          item.startDate = parseTime(item.startDate);\n        });\n      });\n    },\n    getmedicineDiseIdList: function getmedicineDiseIdList() {\n      var _this6 = this;\n\n      selectByType({\n        staffId: this.$store.getters.id,\n        selectType: 2\n      }).then(function (res) {\n        _this6.medicineDiseIdList = res.data.medicineDiseList;\n      });\n    },\n    submitPriliminaryDise: function submitPriliminaryDise() {\n      var _this7 = this;\n\n      this.priliminaryDise.registrationId = this.patient.registrationId;\n      this.record.forEach(function (item) {\n        _this7.priliminaryDise.priliminaryDiseStrList += item.name + ',';\n        _this7.priliminaryDise.priliminaryDiseIdList += item.id + ',';\n      });\n      this.priliminaryDise.priliminaryDiseStrList = this.priliminaryDise.priliminaryDiseStrList.substr(0, this.priliminaryDise.priliminaryDiseStrList.length - 1);\n      this.priliminaryDise.priliminaryDiseIdList = this.priliminaryDise.priliminaryDiseIdList.substr(0, this.priliminaryDise.priliminaryDiseIdList.length - 1);\n      this.priliminaryDise.name = this.patient.patientName;\n      this.priliminaryDise.gender = this.patient.patientGender;\n      this.priliminaryDise.startDate = parseTime(this.priliminaryDise.startDate).substr(0, 10);\n      this.priliminaryDise.ageStr = this.patient.patientAge;\n\n      _submitPriliminaryDise(this.priliminaryDise).then(function (res) {\n        _this7.$notify({\n          title: '成功',\n          message: '成功提交初诊病历',\n          type: 'success',\n          duration: 2000\n        });\n\n        _this7.$emit('priliminary');\n      });\n    },\n    deleteDis: function deleteDis(row) {\n      this.record = this.record.filter(function (item) {\n        if (item.id === row.id) return false;\n        return true;\n      });\n    },\n    selectDis: function selectDis(val) {\n      var _this8 = this;\n\n      this.$confirm('是否添加 ' + val.name + ' 到该患者?', '添加诊断', {\n        confirmButtonText: '确认',\n        cancelButtonText: '取消',\n        type: 'success'\n      }).then(function () {\n        var flag = 1;\n        if (flag) _this8.record.push(val);else alert('已存在该诊断！');\n        _this8.dialogTableVisible = false;\n      });\n    },\n    getDis: function () {\n      var _getDis = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n        var res;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return getDmsDislist(this.disQuery);\n\n              case 2:\n                res = _context.sent;\n                this.disList = res.data.list;\n                this.total = res.data.total;\n\n              case 5:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function getDis() {\n        return _getDis.apply(this, arguments);\n      }\n\n      return getDis;\n    }(),\n    loadpatient: function loadpatient() {},\n    addDis: function addDis() {\n      this.dialogTableVisible = true;\n      this.getDis();\n    },\n    controlfast: function controlfast() {\n      this.isclose = !this.isclose;\n      if (this.mainwidth === \"60%\") this.mainwidth = \"80%\";else this.mainwidth = \"60%\";\n    }\n  }\n};",null]}