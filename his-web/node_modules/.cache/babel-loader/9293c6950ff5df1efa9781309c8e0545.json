{"remainingRequest":"F:\\XM\\his-web\\node_modules\\thread-loader\\dist\\cjs.js!F:\\XM\\his-web\\node_modules\\babel-loader\\lib\\index.js!F:\\XM\\his-web\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!F:\\XM\\his-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\XM\\his-web\\src\\views\\outpatient\\workstation\\handle.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\XM\\his-web\\src\\views\\outpatient\\workstation\\handle.vue","mtime":1602049438427},{"path":"F:\\XM\\his-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1600936410370},{"path":"F:\\XM\\his-web\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1600936436646},{"path":"F:\\XM\\his-web\\node_modules\\babel-loader\\lib\\index.js","mtime":1600936408645},{"path":"F:\\XM\\his-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1600936410370},{"path":"F:\\XM\\his-web\\node_modules\\vue-loader\\lib\\index.js","mtime":1600936442292}],"contextDependencies":[],"result":["import \"core-js/modules/es7.array.includes\";\nimport \"core-js/modules/es6.string.includes\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"F:/XM/his-web/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.string.iterator\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { getNondrugList as _getNondrugList } from '@/api/non_drug';\nimport { apply as _apply, list, invalid as _invalid, deleteById } from '@/api/outpatient/nondrugapply';\nimport { getNondrugModelList } from '@/api/nondrugmodel';\nimport { deepClone } from '@/utils';\nimport { selectByType } from '@/api/outpatient/frequentuse';\nimport { saveNonDrug as _saveNonDrug, getNonDrug as _getNonDrug } from '@/api/outpatient/save';\nimport { Promise, all } from 'q';\nexport default {\n  props: ['patient'],\n  name: 'Inspection',\n  data: function data() {\n    return {\n      freqlist: [],\n      onemodel: {},\n      totalprice: 0.000,\n      ref: [],\n      checkmodels: [],\n      check: {},\n      demandVisible: false,\n      dialogTableVisible: false,\n      activeName: 'first',\n      isclose: true,\n      checkList: [],\n      mainwidth: \"65%\",\n      activeNames: ['1'],\n      total: 0,\n      search: '',\n      listQuery: {\n        code: null,\n        name: null,\n        format: null,\n        price: null,\n        expClassId: null,\n        deptId: null,\n        mnemonicCode: null,\n        recordType: 3,\n        createDate: null,\n        status: 1,\n        pageSize: 1000,\n        pageNum: 1\n      },\n      record: []\n    };\n  },\n  watch: {\n    'patient': function patient(newVal, oldVal) {\n      this.patient = newVal;\n      this.listRecord();\n    }\n  },\n  created: function created() {\n    var _this = this;\n\n    Promise.all([this.getNondrugList().then(function () {\n      _this.getmodel();\n    })]);\n    this.getfreqList();\n  },\n  methods: {\n    saveNonDrug: function saveNonDrug() {\n      var _this2 = this;\n\n      var data = {};\n      data.dmsNonDrugItemRecordParamList = this.ref;\n      data.registrationId = this.patient.registrationId;\n      data.type = 2;\n\n      _saveNonDrug(data).then(function (res) {\n        _this2.$notify({\n          title: '成功',\n          message: '已暂存选中的处置项',\n          type: 'success',\n          duration: 2000\n        });\n      });\n    },\n    getNonDrug: function getNonDrug() {\n      var _this3 = this;\n\n      var data = {};\n      data.registrationId = this.patient.registrationId;\n      data.type = 2;\n\n      _getNonDrug(data).then(function (res) {\n        res.data.dmsNonDrugItemRecordParamList.forEach(function (item) {\n          _this3.selectCheckred(item);\n        });\n\n        _this3.$notify({\n          title: '成功',\n          message: '已取出暂存的处置项',\n          type: 'success',\n          duration: 2000\n        });\n      });\n    },\n    addfreitem: function addfreitem(val) {\n      this.selectCheck(val);\n    },\n    getfreqList: function getfreqList() {\n      var _this4 = this;\n\n      var data = {};\n      data.staffId = this.$store.getters.id;\n      data.selectType = 3;\n      selectByType(data).then(function (res) {\n        _this4.freqlist = res.data.dispositionList;\n      });\n    },\n    addModel: function addModel(val) {\n      var _this5 = this;\n\n      this.$confirm('是否确定将 模板:' + val.name + ' 中的内容导入该患者的检查中', '导入模板', {\n        confirmButtonText: '确认',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(function () {\n        val.nondruglist.forEach(function (item) {\n          item.status = -1;\n          var flag = 1;\n\n          _this5.record.forEach(function (com) {\n            if (com.id === item.id) {\n              flag = 0;\n            }\n          });\n\n          if (flag) _this5.record.push(item);\n        });\n      });\n    },\n    selectModel: function selectModel(val) {\n      this.onemodel = val;\n      console.log(this.onemodel);\n    },\n    getmodel: function () {\n      var _getmodel = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n        var _this6 = this;\n\n        var data;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                data = {};\n                data.scope = 0;\n                data.ownId = this.$store.getters.id;\n                data.type = 2;\n                data.pageSize = 10000;\n                data.pageNum = 1;\n                data.isAdmin = 0;\n                _context.next = 9;\n                return getNondrugModelList(data).then(function (res) {\n                  _this6.checkmodels = res.data.list;\n\n                  _this6.checkmodels.forEach(function (onemodel) {\n                    onemodel.nondruglist = [];\n                    onemodel.totalprice = 0.00;\n\n                    _this6.checkList.filter(function (item) {\n                      if (onemodel.nonDrugIdList.includes(item.id)) {\n                        onemodel.nondruglist.push(item);\n                        onemodel.totalprice += item.price;\n                      }\n                    });\n                  });\n                });\n\n              case 9:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function getmodel() {\n        return _getmodel.apply(this, arguments);\n      }\n\n      return getmodel;\n    }(),\n    refresh: function refresh() {\n      var _this7 = this;\n\n      this.$confirm('未开立的项目都将清除,确认刷新?', '刷新', {\n        confirmButtonText: '确认',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(function () {\n        _this7.listRecord();\n      });\n    },\n    invalid: function invalid() {\n      var _this8 = this;\n\n      var data = '';\n      this.ref.forEach(function (item) {\n        data += item.id + ',';\n      });\n      data = data.substr(0, data.length - 1);\n\n      _invalid(data).then(function (res) {\n        _this8.$notify({\n          title: '成功',\n          message: res.message,\n          type: 'success',\n          duration: 2000\n        });\n\n        _this8.listRecord();\n      });\n    },\n    listRecord: function () {\n      var _listRecord = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {\n        var _this9 = this;\n\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                list(this.patient.registrationId, 2).then(function (res) {\n                  _this9.record = res.data;\n                  console.log(_this9.record);\n\n                  _this9.record.forEach(function (item) {\n                    _this9.checkList.filter(function (check) {\n                      if (check.id === item.noDrugId) {\n                        item.code = check.code;\n                        item.name = check.name;\n                        item.format = check.format;\n                        item.price = check.price;\n                      }\n                    });\n\n                    item.deptName = item.excuteDeptName;\n                  });\n                });\n\n              case 1:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function listRecord() {\n        return _listRecord.apply(this, arguments);\n      }\n\n      return listRecord;\n    }(),\n    handleSelectionChange: function handleSelectionChange(val) {\n      var _this10 = this;\n\n      this.ref = val;\n      this.totalprice = 0.00;\n      this.ref.forEach(function (item) {\n        _this10.totalprice += item.price;\n      });\n      this.totalprice = this.totalprice.toFixed(2);\n    },\n    handleClick: function handleClick() {\n      this.$notify({\n        title: '暂无数据',\n        message: '您开立的项目中包含已开立的项目，请检查后重新提交！',\n        type: 'warning',\n        duration: 2000\n      });\n      return false;\n    },\n    apply: function apply() {\n      var _this11 = this;\n\n      var flags = 0;\n      this.ref.forEach(function (item) {\n        if (item.status != -1) {\n          _this11.handleClick();\n\n          flags = 1;\n        }\n      });\n\n      if (flags === 0) {\n        var data = {};\n        data.dmsNonDrugItemRecordParamList = this.ref;\n        data.createStaffId = this.$store.getters.id;\n        data.registrationId = this.patient.registrationId;\n        data.dmsNonDrugItemRecordParamList.forEach(function (item) {\n          item.amount = item.price;\n          item.excuteDeptId = item.deptId;\n          item.noDrugId = item.id;\n        });\n        data.type = 2;\n\n        _apply(data).then(function (res) {\n          _this11.$notify({\n            title: '成功',\n            message: res.message,\n            type: 'success',\n            duration: 2000\n          });\n\n          _this11.listRecord();\n        });\n      }\n    },\n    submitDemand: function submitDemand() {\n      var _this12 = this;\n\n      this.record.forEach(function (item) {\n        if (item.id === _this12.check.id) {\n          item.aim = _this12.check.aim;\n          item.demand = _this12.check.demand;\n          item.clinicalImpression = _this12.check.clinicalImpression;\n          item.clinicalDiagnosis = _this12.check.clinicalDiagnosis;\n          item.checkParts = _this12.check.checkParts;\n        }\n      });\n      this.demandVisible = false;\n    },\n    demand: function demand(row) {\n      this.demandVisible = true;\n      this.check = deepClone(row);\n    },\n    getNondrugList: function () {\n      var _getNondrugList2 = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3() {\n        var response;\n        return regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return _getNondrugList(this.listQuery);\n\n              case 2:\n                response = _context3.sent;\n                console.log(response);\n                this.checkList = response.data.list;\n                this.total = response.data.total;\n\n              case 6:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function getNondrugList() {\n        return _getNondrugList2.apply(this, arguments);\n      }\n\n      return getNondrugList;\n    }(),\n    selectCheckred: function selectCheckred(val) {\n      var flag = 1;\n      val.status = -1;\n      this.record.forEach(function (item) {\n        if (item.id === val.id) {\n          flag = 0;\n        }\n      });\n      if (flag) this.record.push(val);\n      this.dialogTableVisible = false;\n    },\n    selectCheck: function selectCheck(val) {\n      var _this13 = this;\n\n      val.status = 0;\n      this.$confirm('是否添加 ' + val.name + ' 到该患者?', '添加检查', {\n        confirmButtonText: '确认',\n        cancelButtonText: '取消',\n        type: 'success'\n      }).then(function () {\n        var flag = 1;\n        val.status = -1;\n\n        _this13.record.forEach(function (item) {\n          if (item.id === val.id) {\n            flag = 0;\n          }\n        });\n\n        if (flag) _this13.record.push(val);else alert('已存在该检查项目！');\n        _this13.dialogTableVisible = false;\n      });\n    },\n    addcheck: function addcheck() {\n      this.dialogTableVisible = true;\n    },\n    delcheck: function delcheck() {\n      var _this14 = this;\n\n      var data = '';\n      this.ref.forEach(function (item) {\n        data += item.id + ',';\n      });\n      data = data.substr(0, data.length - 1);\n      deleteById(data).then(function (res) {\n        _this14.$notify({\n          title: '成功',\n          message: res.message,\n          type: 'success',\n          duration: 2000\n        });\n\n        _this14.listRecord();\n      });\n    },\n    controlfast: function controlfast() {\n      this.isclose = !this.isclose;\n      if (this.mainwidth === \"65%\") this.mainwidth = \"80%\";else this.mainwidth = \"65%\";\n    }\n  }\n};",null]}