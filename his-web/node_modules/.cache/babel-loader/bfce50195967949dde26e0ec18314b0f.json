{"remainingRequest":"F:\\XM\\his-web\\node_modules\\babel-loader\\lib\\index.js!F:\\XM\\his-web\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!F:\\XM\\his-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\XM\\his-web\\src\\views\\pharmacy\\herbal.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\XM\\his-web\\src\\views\\pharmacy\\herbal.vue","mtime":1601284228920},{"path":"F:\\XM\\his-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1600936410370},{"path":"F:\\XM\\his-web\\node_modules\\babel-loader\\lib\\index.js","mtime":1600936408645},{"path":"F:\\XM\\his-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1600936410370},{"path":"F:\\XM\\his-web\\node_modules\\vue-loader\\lib\\index.js","mtime":1600936442292}],"contextDependencies":[],"result":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"core-js/modules/es6.function.name\");\n\nrequire(\"core-js/modules/web.dom.iterable\");\n\nvar _drugstore = require(\"@/api/drugstore\");\n\nvar _utils = require(\"@/utils\");\n\nvar _cprescription = require(\"@/api/outpatient/cprescription\");\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nvar _default = {\n  data: function data() {\n    return {\n      selectid: '',\n      refundVisible: false,\n      refundamout: 1,\n      refundlimit: 0,\n      refundid: '',\n      searchpatient: '',\n      sendrefs: [],\n      druglist: [],\n      druglistgiven: [],\n      patient: {},\n      undoPatientList: [],\n      donePatientList: [],\n      visible: false,\n      isGiven: false,\n      spanArr: [],\n      isaside: true,\n      activeName: 'first',\n      activeName2: 'first',\n      position: 0\n    };\n  },\n  created: function created() {\n    this.listPatient();\n  },\n  methods: {\n    refundDrug: function refundDrug() {\n      var _this = this;\n\n      if (this.refundamout > this.refundlimit) {\n        this.$notify({\n          title: '错误',\n          message: '输入数量大于可退药数量！',\n          type: 'warning',\n          duration: 2000\n        });\n      } else if (this.refundamout <= 0) {\n        this.$notify({\n          title: '错误',\n          message: '退药数量不能小于1！',\n          type: 'warning',\n          duration: 2000\n        });\n      } else {\n        var data = {};\n        data.excutorId = this.$store.getters.id;\n        data.refundItemList = [];\n        var temp = {};\n        temp.refundNum = this.refundamout;\n        temp.refundPrescriptionItemId = this.refundid;\n        temp.type = 4;\n        data.refundItemList.push(temp);\n        (0, _drugstore.refundDrug)(data).then(function (res) {\n          _this.$notify({\n            title: '成功',\n            message: '退药成功',\n            type: 'success',\n            duration: 2000\n          });\n\n          _this.refundVisible = false;\n\n          _this.listPatient();\n\n          _this.druglistgiven = [];\n        });\n      }\n    },\n    refund: function refund(val) {\n      this.refundVisible = true;\n      this.refundlimit = val.currentNum;\n      this.refundid = val.drugid;\n    },\n    sendDrug: function sendDrug() {\n      var _this2 = this;\n\n      if (this.sendrefs.length === 0) {\n        this.$notify({\n          title: '提示',\n          message: \"请选择一条数据！\",\n          type: 'warning',\n          duration: 2000\n        });\n        return;\n      }\n\n      this.sendrefs.forEach(function (item) {\n        (0, _drugstore.releaseDrug)(item.prescriptionId, 4).then(function (res) {\n          _this2.$notify({\n            title: '成功',\n            message: res.message,\n            type: 'success',\n            duration: 2000\n          });\n\n          _this2.listPatient();\n\n          _this2.druglist = [];\n          _this2.druglistgiven = [];\n        });\n      });\n    },\n    changedep: function changedep(val) {\n      this.sendrefs = val;\n    },\n    rowspan: function rowspan() {\n      var _this3 = this;\n\n      this.spanArr = []; //在data里面定义\n\n      this.position = 0; //在data里面定义\n\n      this.druglist.forEach(function (item, index) {\n        if (index === 0) {\n          _this3.spanArr.push(1);\n\n          _this3.position = 0;\n          item.sequence = index + 1; //设置序号\n        } else {\n          if (_this3.druglist[index].id === _this3.druglist[index - 1].id) {\n            _this3.spanArr[_this3.position] += 1; //连续有几行项目名名称相同\n\n            _this3.spanArr.push(0); // 名称相同后往数组里面加一项0\n            //当项目名称相同时，设置当前序号和前一个相同\n\n\n            _this3.druglist[index].sequence = _this3.druglist[index - 1].sequence;\n          } else {\n            _this3.spanArr.push(1);\n\n            _this3.position = index; //当项目名称不同时，将当前序号设置为前一个序号+1\n\n            _this3.druglist[index].sequence = _this3.druglist[index - 1].sequence + 1;\n          }\n        }\n      });\n    },\n    objectSpanMethod: function objectSpanMethod(_ref) {\n      var row = _ref.row,\n          column = _ref.column,\n          rowIndex = _ref.rowIndex,\n          columnIndex = _ref.columnIndex;\n\n      //表格合并行\n      if (columnIndex === 0) {\n        //序号列也进行合并(第一列)\n        //this.spanArr这个数组里面存的是table里面连续的有几条数据相同\n        //例如:[1,1,2,0,2,0]\n        //1  代表的没有连续的相同的\n        //2  代表连续的两个相同\n        //0  代表是和上一条内容相同\n        var _row = this.spanArr[rowIndex];\n\n        var _col = _row > 0 ? 1 : 0;\n\n        return {\n          rowspan: _row,\n          //行\n          colspan: _col //列\n\n        };\n      }\n\n      if (columnIndex === 1) {\n        //项目列也进行合并(第二列)\n        var _row2 = this.spanArr[rowIndex];\n\n        var _col2 = _row2 > 0 ? 1 : 0;\n\n        return {\n          rowspan: _row2,\n          colspan: _col2\n        };\n      }\n    },\n    listPatient: function listPatient() {\n      var _this4 = this;\n\n      var data = {};\n      data.queryDate = (0, _utils.parseTime)(new Date());\n      data.queryDate = data.queryDate.substr(0, 10);\n      data.type = 4;\n      (0, _drugstore.listPatient)(data).then(function (res) {\n        _this4.undoPatientList = res.data.undoPatientList;\n        _this4.donePatientList = res.data.donePatientList;\n      });\n    },\n    handleGive2: function handleGive2() {\n      var _this5 = this;\n\n      var data = {};\n      data.queryDate = (0, _utils.parseTime)(new Date()).substr(0, 10);\n      data.type = 4;\n      (0, _drugstore.listPatient)(data).then(function (res) {\n        _this5.undoPatientList = res.data.undoPatientList;\n        _this5.donePatientList = res.data.donePatientList;\n        var flag = 0;\n\n        _this5.undoPatientList.forEach(function (item) {\n          if (item.patientId === _this5.patient.patientId) {\n            flag = 1;\n            _this5.patient = (0, _utils.deepClone)(item);\n          }\n        });\n\n        _this5.druglist = [];\n        _this5.isGiven = false;\n        var data = '';\n\n        _this5.patient.prescriptionIdList.forEach(function (item) {\n          data += item + ',';\n        });\n\n        data = data.substr(0, data.length - 1);\n        (0, _cprescription.listByIds)(data).then(function (res) {\n          res.data.forEach(function (item) {\n            var temp = item.id;\n            item.dmsHerbalItemRecordResultList.forEach(function (drug) {\n              drug.drugid = drug.id;\n              drug.id = temp;\n\n              _this5.druglist.push((0, _utils.deepClone)(drug));\n            });\n          });\n\n          _this5.rowspan();\n        });\n      });\n    },\n    handleGive: function handleGive(val) {\n      var _this6 = this;\n\n      this.druglist = [];\n      this.isGiven = false;\n      this.patient = (0, _utils.deepClone)(val);\n      var data = '';\n      this.patient.prescriptionIdList.forEach(function (item) {\n        data += item + ',';\n      });\n      data = data.substr(0, data.length - 1);\n      (0, _cprescription.listByIds)(data).then(function (res) {\n        res.data.forEach(function (item) {\n          var temp = item.id;\n          var temp2 = item.name;\n          var temp3 = item.createStaffName;\n          item.dmsHerbalItemRecordResultList.forEach(function (drug) {\n            drug.drugid = drug.id;\n            drug.id = temp;\n            drug.doctorname = temp3;\n            drug.cname = temp2;\n\n            _this6.druglist.push((0, _utils.deepClone)(drug));\n          });\n        });\n\n        _this6.rowspan();\n      });\n    },\n    handleGiven: function handleGiven(val) {\n      var _this7 = this;\n\n      this.isGiven = true;\n      this.druglistgiven = [];\n      this.patient = (0, _utils.deepClone)(val);\n      var data = '';\n      this.patient.prescriptionIdList.forEach(function (item) {\n        data += item + ',';\n      });\n      data = data.substr(0, data.length - 1);\n      (0, _cprescription.listByIds)(data).then(function (res) {\n        res.data.forEach(function (item) {\n          var temp = item.id;\n          var temp2 = item.name;\n          var temp3 = item.createStaffName;\n          item.dmsHerbalItemRecordResultList.forEach(function (drug) {\n            drug.drugid = drug.id;\n            drug.id = temp;\n            drug.doctorname = temp3;\n            drug.cname = temp2;\n\n            _this7.druglistgiven.push((0, _utils.deepClone)(drug));\n          });\n        });\n      });\n    },\n    showaside: function showaside() {\n      this.isaside = !this.isaside;\n    },\n    register: function register() {\n      this.$confirm('确定为 王小虎1 登记项目 验血 吗?', '项目登记', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      });\n    }\n  }\n};\nexports.default = _default;",null]}