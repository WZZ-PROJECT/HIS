{"remainingRequest":"F:\\XM\\his-web\\node_modules\\thread-loader\\dist\\cjs.js!F:\\XM\\his-web\\node_modules\\babel-loader\\lib\\index.js!F:\\XM\\his-web\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!F:\\XM\\his-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\XM\\his-web\\src\\views\\permission\\role.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\XM\\his-web\\src\\views\\permission\\role.vue","mtime":1601255915657},{"path":"F:\\XM\\his-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1600936410370},{"path":"F:\\XM\\his-web\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1600936436646},{"path":"F:\\XM\\his-web\\node_modules\\babel-loader\\lib\\index.js","mtime":1600936408645},{"path":"F:\\XM\\his-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1600936410370},{"path":"F:\\XM\\his-web\\node_modules\\vue-loader\\lib\\index.js","mtime":1600936442292}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"F:/XM/his-web/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { create, select as _select, update, uploadFileAli } from '@/api/user';\nimport { parseTime, deepClone } from '@/utils';\nimport { getRulelist } from '@/api/schedule';\nimport { getAllDep } from '@/api/department';\nimport Pagination from '@/components/Pagination';\nimport { policy, uploadResult } from '@/api/upload';\nimport { Promise } from 'q';\nexport default {\n  components: {\n    Pagination: Pagination\n  },\n  props: ['uploadpatient'],\n  name: 'Upload',\n  data: function data() {\n    return {\n      img: '',\n      alldepart: [],\n      user: {\n        id: '',\n        username: '',\n        name: '',\n        role: '',\n        dept: '',\n        deptname: '',\n        picture: '',\n        title: '',\n        advantages: '',\n        description: '',\n        status: ''\n      },\n      total: 0,\n      userlist: [],\n      listQuery: {\n        deptId: '',\n        gender: '',\n        username: '',\n        roleId: '',\n        pageSize: 10,\n        pageNum: 1\n      },\n      imageUrl: '',\n      dialogType: '',\n      dialogVisible: false,\n      rules: {\n        picture: [{\n          required: true,\n          message: '请上传头像',\n          trigger: 'blur'\n        }],\n        username: [{\n          required: true,\n          message: '请输入用户名称',\n          trigger: 'blur'\n        }],\n        password: [{\n          required: true,\n          message: '请输入密码',\n          trigger: 'blur'\n        }, {\n          min: 4,\n          max: 16,\n          message: '长度在 4 到 16 个字符',\n          trigger: 'blur'\n        }],\n        name: [{\n          required: true,\n          message: '请输入真实姓名',\n          trigger: 'blur'\n        }],\n        role: [{\n          required: true,\n          message: '请选择角色',\n          trigger: 'blur'\n        }],\n        dept: [{\n          required: true,\n          message: '请选择科室',\n          trigger: 'blur'\n        }],\n        advantages: [{\n          required: true,\n          message: '请输入医生擅长',\n          trigger: 'blur'\n        }],\n        title: [{\n          required: true,\n          message: '请输入备注',\n          trigger: 'blur'\n        }],\n        description: [{\n          required: true,\n          message: '请输入医生介绍',\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n  watch: {\n    'uploadpatient': function uploadpatient(newVal, oldVal) {\n      this.uploadpatient = newVal;\n    }\n  },\n  created: function created() {\n    var _this = this;\n\n    this.select();\n    this.getAlldep();\n    policy().then(function (res) {\n      _this.dataObj = res.data;\n    });\n  },\n  methods: {\n    getAlldep: function () {\n      var _getAlldep = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n        var res;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return getAllDep();\n\n              case 2:\n                res = _context.sent;\n                this.alldepart = res.data;\n\n              case 4:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function getAlldep() {\n        return _getAlldep.apply(this, arguments);\n      }\n\n      return getAlldep;\n    }(),\n    getRuleList: function getRuleList() {\n      var _this2 = this;\n\n      if (this.depart !== '') {\n        this.ruleList = [];\n        this.listQuery.deptId = this.depart;\n        getRulelist(this.listQuery).then(function (res) {\n          _this2.ruleList = res.data.list;\n\n          _this2.ruleList.forEach(function (item) {\n            item.operateTime = parseTime(item.operateTime);\n          });\n\n          _this2.total = res.data.total;\n        });\n      }\n    },\n    confirmUser: function confirmUser(user) {\n      var _this3 = this;\n\n      this.$refs[user].validate(function (valid) {\n        if (valid) {\n          if (_this3.dialogType === 'add') {\n            _this3.user.deptId = _this3.user.dept;\n            _this3.user.roleId = _this3.user.role;\n            _this3.user.registrationRankId = 1;\n            _this3.user.gender = 0;\n            create(_this3.user).then(function (res) {\n              _this3.$notify({\n                title: '成功',\n                message: '成功新增用户',\n                type: 'success',\n                duration: 2000\n              });\n\n              _this3.select();\n            });\n            _this3.dialogVisible = false;\n          } else {\n            _this3.user.deptId = _this3.user.dept;\n            _this3.user.roleId = _this3.user.role;\n            update(_this3.user).then(function (res) {\n              _this3.$notify({\n                title: '成功',\n                message: '修改成功',\n                type: 'success',\n                duration: 2000\n              });\n\n              _this3.select();\n            });\n            _this3.dialogVisible = false;\n          }\n        } else {\n          return;\n        }\n      });\n    },\n    select: function select() {\n      var _this4 = this;\n\n      _select(this.listQuery).then(function (res) {\n        _this4.userlist = res.data.list;\n        _this4.total = res.data.total;\n        console.log(_this4.userlist);\n\n        _this4.userlist.forEach(function (item) {\n          item.createTime = parseTime(item.createTime);\n        });\n      });\n    },\n    handleAddRole: function handleAddRole() {\n      this.user.picture = '';\n      this.user.id = '';\n      this.user.name = '';\n      this.user.role = '';\n      this.user.username = '';\n      this.user.dept = '';\n      this.user.title = '';\n      this.user.advantages = '';\n      this.user.description = '';\n      this.dialogType = 'add';\n      this.dialogVisible = true;\n    },\n    handleEdit: function handleEdit(row) {\n      this.dialogType = 'edit';\n      this.user.id = row.id;\n      this.user.username = JSON.parse(JSON.stringify(row.username));\n      this.user.name = JSON.parse(JSON.stringify(row.name));\n      this.user.role = row.role.id;\n      this.user.dept = row.dept.id;\n      this.user.deptname = row.dept.name;\n      this.user.picture = row.picture;\n      this.user.title = row.title;\n      this.user.advantages = row.advantages;\n      this.user.description = row.description;\n      this.dialogVisible = true;\n      console.log(this.user);\n    },\n    handleDelete: function handleDelete(row) {\n      var _this5 = this;\n\n      this.$confirm('确定为 ' + row.dept.name + ' 的 ' + row.name + ' 用户吗?', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(function () {\n        _this5.user.id = row.id;\n        _this5.user.status = 0;\n        update(_this5.user).then(function (res) {\n          _this5.$notify({\n            title: '成功',\n            message: '删除成功',\n            type: 'success',\n            duration: 2000\n          });\n\n          _this5.select();\n        });\n      });\n    },\n    //头像上传\n    uploadFile: function uploadFile(headers) {\n      uploadFileAli(headers.file, this.toUrl);\n    },\n    //附件上传回调\n    toUrl: function toUrl(file, url) {\n      var urls = {\n        uid: file.uid,\n        url: url,\n        name: file.name\n      };\n      this.user.picture = url;\n    },\n    //删除附件\n    handleRemove: function handleRemove(file, fileList) {\n      var _this6 = this;\n\n      this.form.fileList.forEach(function (item, idx) {\n        if (item.uid == file.uid) {\n          _this6.form.fileList.splice(idx, 1);\n        }\n      });\n    },\n    beforeRemove: function beforeRemove(file, fileList) {\n      return this.$confirm(\"\\u786E\\u5B9A\\u79FB\\u9664 \".concat(file.name, \"\\uFF1F\"));\n    }\n  }\n};",null]}