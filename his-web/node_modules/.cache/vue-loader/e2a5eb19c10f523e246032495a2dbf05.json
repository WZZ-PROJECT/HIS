{"remainingRequest":"F:\\XM\\his-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\XM\\his-web\\src\\views\\outpatient\\workstation\\historyComfirm.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\XM\\his-web\\src\\views\\outpatient\\workstation\\historyComfirm.vue","mtime":1602056307730},{"path":"F:\\XM\\his-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1600936410370},{"path":"F:\\XM\\his-web\\node_modules\\babel-loader\\lib\\index.js","mtime":1600936408645},{"path":"F:\\XM\\his-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1600936410370},{"path":"F:\\XM\\his-web\\node_modules\\vue-loader\\lib\\index.js","mtime":1600936442292}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport {getnonend,submitdefinite,Clinical} from '@/api/outpatient/dmscase'\r\nimport {getDmsDislist,parseList} from '@/api/diagnosis'\r\nimport Pagination from '@/components/Pagination'\r\nimport {selectByType} from '@/api/outpatient/frequentuse'\r\nimport {parseTime} from '@/utils'\r\nexport default {\r\n  props:['patient'],\r\n  components: {Pagination},\r\n  name:'Comfirm',\r\n  data(){\r\n    return{\r\n      registrationId:'',\r\n      medicineDiseIdList:[],\r\n      dialogTableVisible:false,\r\n      total:0,\r\n      record:[],\r\n      records:[],\r\n      disQuery: {\r\n        catId: '',\r\n        code: '',\r\n        name: '',\r\n        icd: '',\r\n        status: '',\r\n        pageSize: 8,\r\n        pageNum: 1\r\n      },\r\n      disList:[],\r\n      prerecord:{\r\n        chiefComplaint:'',\r\n        historyOfPresentIllness:'',\r\n        historyOfTreatment:'',\r\n        pastHistory:'',\r\n        allergies:'',\r\n        healthCheckup:'',\r\n        checkResult:'',\r\n        testResult:'',\r\n        priliminaryDiseIdList:''\r\n      },\r\n      activeName:'first',\r\n      isclose:true,\r\n      mainwidth:\"60%\",\r\n      activeNames: ['1'],\r\n    };\r\n  },\r\n  created(){\r\n    this.getmedicineDiseIdList()\r\n    this.registrationId=this.patient.registrationId\r\n    console.log(this.registrationId)\r\n  /*  this.Clinical();*/\r\n  },\r\n  watch:{\r\n    'patient' : function(newVal, oldVal){\r\n      this.patient = newVal\r\n      /*this.getnonend()*/\r\n      this.Clinical();\r\n    },\r\n  },\r\n  methods:{\r\n    getmedicineDiseIdList(){\r\n      selectByType({staffId:this.$store.getters.id,selectType:2}).then(res=>{\r\n        this.medicineDiseIdList = res.data.medicineDiseList\r\n      })\r\n    },\r\n    submitdefinite(){\r\n      this.prerecord.definiteDiseStrList = ''\r\n      this.record.forEach(item=>{\r\n        this.prerecord.definiteDiseStrList += (item.id+',')\r\n      })\r\n      this.prerecord.startDate = parseTime(this.prerecord.startDate,'{y}-{m}-{d}')\r\n      this.prerecord.createTime = parseTime(this.prerecord.createTime,'{y}-{m}-{d}')\r\n      this.prerecord.definiteDiseStrList = this.prerecord.definiteDiseStrList.substr(0, this.prerecord.definiteDiseStrList.length - 1);\r\n      submitdefinite(this.prerecord).then(res=>{\r\n          this.$notify({\r\n          title: '成功',\r\n          message: '已确诊!',\r\n          type: 'success',\r\n          duration: 2000\r\n        })\r\n        this.$emit('comfirmdms',2)\r\n\r\n      })\r\n    },\r\n    deleteDis(row){\r\n      this.record=this.record.filter(item=>{\r\n        if(item.id===row.id)\r\n          return false\r\n        return true\r\n      })\r\n\r\n    },\r\n    selectDis(val){\r\n      this.$confirm('是否添加 '+val.name+' 到该患者?', '添加诊断', {\r\n          confirmButtonText: '确认',\r\n          cancelButtonText: '取消',\r\n          type: 'success'\r\n        }).then(()=>{\r\n          let flag = true\r\n        if(this.record==null){\r\n          this.record=[]\r\n        }\r\n        if(this.record.length==0){\r\n          this.record.push(val)\r\n        }else {\r\n          if(flag) {\r\n            this.record.push(val)\r\n          }else {\r\n            alert('已存在该诊断！')\r\n          }\r\n        }\r\n          this.dialogTableVisible = false\r\n        })\r\n    },\r\n    addDis(){\r\n      this.dialogTableVisible=true\r\n      this.getDis()\r\n    },\r\n    async getDis(){\r\n      const res = await getDmsDislist(this.disQuery)\r\n      this.disList = res.data.list\r\n      this.total = res.data.total\r\n    },\r\n    getnonend(){\r\n      getnonend(this.patient.registrationId).then(res=>{\r\n\r\n        this.prerecord = res.data.dmsCaseHistoryList[0]\r\n        console.log(this.prerecord)\r\n        parseList(this.prerecord.priliminaryDiseIdList).then(res=>{\r\n          this.record = res.data\r\n          console.log(this.record)\r\n        })\r\n      })\r\n    },\r\n    Clinical(){\r\n      Clinical(this.patient.registrationId).then(res=>{\r\n        this.prerecord.chiefComplaint=res.data.dmsCaseHistoryList[0].chiefComplaint\r\n        this.prerecord.historyOfPresentIllness=res.data.dmsCaseHistoryList[0].historyOfPresentIllness\r\n        this.prerecord.historyOfTreatment=res.data.dmsCaseHistoryList[0].historyOfTreatment\r\n        this.prerecord.pastHistory=res.data.dmsCaseHistoryList[0].pastHistory\r\n        this.prerecord.allergies=res.data.dmsCaseHistoryList[0].allergies\r\n        this.prerecord.healthCheckup=res.data.dmsCaseHistoryList[0].healthCheckup\r\n        this.prerecord.checkResult=res.data.dmsCaseHistoryList[0].checkResult\r\n        this.prerecord.testResult=res.data.dmsCaseHistoryList[0].testResult\r\n        this.prerecord.priliminaryDiseIdList=res.data.dmsCaseHistoryList[0].priliminaryDiseIdList\r\n        parseList(this.prerecord.priliminaryDiseIdList).then(pars=>{\r\n          this.records=pars.data\r\n          console.log(this.records)\r\n        })\r\n      })\r\n    },\r\n    controlfast(){\r\n      this.isclose=!this.isclose\r\n      if(this.mainwidth===\"60%\")\r\n        this.mainwidth=\"80%\"\r\n      else\r\n        this.mainwidth=\"60%\"\r\n    }\r\n  }\r\n}\r\n",null]}