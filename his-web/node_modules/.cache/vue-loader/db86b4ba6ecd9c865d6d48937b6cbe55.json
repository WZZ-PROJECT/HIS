{"remainingRequest":"D:\\IdeaProjects\\HIS\\HIS-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\IdeaProjects\\HIS\\HIS-web\\src\\views\\permission\\role.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\IdeaProjects\\HIS\\HIS-web\\src\\views\\permission\\role.vue","mtime":1597809646176},{"path":"D:\\IdeaProjects\\HIS\\HIS-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\IdeaProjects\\HIS\\HIS-web\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\IdeaProjects\\HIS\\HIS-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\IdeaProjects\\HIS\\HIS-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport {create,select,update} from '@/api/user'\nimport {parseTime,deepClone} from '@/utils'\nimport {getRulelist} from '@/api/schedule'\nimport {getAllDep} from '@/api/department'\nimport Pagination from '@/components/Pagination'\nexport default {\n  components: {Pagination},\n  data(){\n    return{\n      alldepart:[],\n      user:{\n        id:'',\n        username:'',\n        name:'',\n        role:'',\n        dept:'',\n        deptname:''\n      },\n      total:0,\n      userlist:[],\n      listQuery:{\n        deptId:'',\n        gender:'',\n        username:'',\n        roleId:'',\n        pageSize:10,\n        pageNum:1\n      },\n      dialogType:'',\n      dialogVisible:false\n    }\n  },\n  created(){\n    this.select()\n    this.getAlldep()\n  },\n  methods:{\n    async getAlldep(){\n      const res = await getAllDep()\n      this.alldepart=res.data\n    },\n    getRuleList (){\n      if(this.depart!==''){\n        this.ruleList = []\n        this.listQuery.deptId=this.depart\n        getRulelist(this.listQuery).then(res=>{\n          this.ruleList=res.data.list\n          this.ruleList.forEach(item=>{\n            item.operateTime = parseTime(item.operateTime)\n          })\n          this.total=res.data.total\n        })\n      }\n    },\n    confirmUser(){\n      if(this.dialogType === 'add'){\n        this.user.deptId = this.user.dept\n        this.user.roleId = this.user.role\n        this.user.registrationRankId = 1\n        this.user.gender = 0\n        create(this.user).then(res=>{\n          this.$notify({\n            title: '成功',\n            message: '成功新增用户',\n            type: 'success',\n            duration: 2000\n          })\n          this.select()\n        })\n        this.dialogVisible = false\n      }\n      else{\n        this.user.deptId = this.user.dept\n        this.user.roleId = this.user.role\n        update(this.user).then(res=>{\n          this.$notify({\n            title: '成功',\n            message: '修改成功',\n            type: 'success',\n            duration: 2000\n          })\n          this.select()\n        })\n        this.dialogVisible = false\n      }\n    },\n    select(){\n      select(this.listQuery).then(res=>{\n        this.userlist = res.data.list\n        this.total = res.data.total\n        console.log(this.userlist)\n        this.userlist.forEach(item=>{\n          item.createTime = parseTime(item.createTime)\n        })\n      })\n    },\n    handleAddRole(){\n      this.user.id = ''\n      this.user.name = ''\n      this.user.role = ''\n      this.user.username = ''\n      this.user.dept = ''\n      this.dialogType = 'add'\n      this.dialogVisible = true\n    },\n    handleEdit(row){\n      this.dialogType = 'edit'\n      this.user.id = row.id\n      this.user.username = JSON.parse(JSON.stringify(row.username))\n      this.user.name =JSON.parse(JSON.stringify(row.name))\n      this.user.role = row.role.id\n      this.user.dept = row.dept.id\n      this.user.deptname = row.dept.name\n      this.dialogVisible = true\n      console.log(this.user)\n    }\n  }\n}\n",null]}