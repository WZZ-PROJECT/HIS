{"remainingRequest":"F:\\XM\\his-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\XM\\his-web\\src\\views\\outpatient\\workstation\\confirm.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\XM\\his-web\\src\\views\\outpatient\\workstation\\confirm.vue","mtime":1601206477686},{"path":"F:\\XM\\his-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1600936410370},{"path":"F:\\XM\\his-web\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1600936436646},{"path":"F:\\XM\\his-web\\node_modules\\babel-loader\\lib\\index.js","mtime":1600936408645},{"path":"F:\\XM\\his-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1600936410370},{"path":"F:\\XM\\his-web\\node_modules\\vue-loader\\lib\\index.js","mtime":1600936442292}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport {getnonend,submitdefinite} from '@/api/outpatient/dmscase'\nimport {getDmsDislist,parseList} from '@/api/diagnosis'\nimport Pagination from '@/components/Pagination'\nimport {selectByType} from '@/api/outpatient/frequentuse'\nimport {parseTime} from '@/utils'\nexport default {\n  props:['patient'],\n  components: {Pagination},\n  name:'Comfirm',\n  data(){\n    return{\n      medicineDiseIdList:[],\n      dialogTableVisible:false,\n      total:0,\n      record:[],\n      disQuery: {\n        catId: '',\n        code: '',\n        name: '',\n        icd: '',\n        status: '',\n        pageSize: 8,\n        pageNum: 1\n      },\n      disList:[],\n      prerecord:{},\n      activeName:'first',\n      isclose:true,\n      mainwidth:\"60%\",\n      activeNames: ['1'],\n      data2:[\n        {\n          date: '0001',\n          name: '王小虎1',\n          address: '38岁'\n        },\n        {\n          date: '0002',\n          name: '王小虎2',\n          address: '39岁'\n        }\n      ]\n    };\n  },\n  created(){\n    this.getmedicineDiseIdList()\n  },\n  watch:{\n    'patient' : function(newVal, oldVal){\n      this.patient = newVal\n      this.getnonend()\n    },\n  },\n  methods:{\n    getmedicineDiseIdList(){\n      selectByType({staffId:this.$store.getters.id,selectType:2}).then(res=>{\n        this.medicineDiseIdList = res.data.medicineDiseList\n      })\n    },\n    submitdefinite(){\n      this.prerecord.definiteDiseStrList = ''\n      this.record.forEach(item=>{\n        this.prerecord.definiteDiseStrList += (item.id+',')\n      })\n      this.prerecord.startDate = parseTime(this.prerecord.startDate,'{y}-{m}-{d}')\n      this.prerecord.createTime = parseTime(this.prerecord.createTime,'{y}-{m}-{d}')\n      this.prerecord.definiteDiseStrList = this.prerecord.definiteDiseStrList.substr(0, this.prerecord.definiteDiseStrList.length - 1);\n      submitdefinite(this.prerecord).then(res=>{\n          this.$notify({\n          title: '成功',\n          message: '已确诊!',\n          type: 'success',\n          duration: 2000\n        })\n        this.$emit('comfirmdms',2)\n\n      })\n    },\n    deleteDis(row){\n      this.record=this.record.filter(item=>{\n        if(item.id===row.id)\n          return false\n        return true\n      })\n\n    },\n    selectDis(val){\n      this.$confirm('是否添加 '+val.name+' 到该患者?', '添加诊断', {\n          confirmButtonText: '确认',\n          cancelButtonText: '取消',\n          type: 'success'\n        }).then(()=>{\n          let flag = true\n        if(this.record==null){\n          this.record=[]\n        }\n        if(this.record.length==0){\n          this.record.push(val)\n        }else {\n          if(flag) {\n            this.record.push(val)\n          }else {\n            alert('已存在该诊断！')\n          }\n        }\n          this.dialogTableVisible = false\n        })\n    },\n    addDis(){\n      this.dialogTableVisible=true\n      this.getDis()\n    },\n    async getDis(){\n      const res = await getDmsDislist(this.disQuery)\n      this.disList = res.data.list\n      this.total = res.data.total\n    },\n    getnonend(){\n      getnonend(this.patient.registrationId).then(res=>{\n        this.prerecord = res.data.dmsCaseHistoryList[0]\n        parseList(this.prerecord.priliminaryDiseIdList).then(res=>{\n          this.record = res.data\n        })\n      })\n    },\n    controlfast(){\n      this.isclose=!this.isclose\n      if(this.mainwidth===\"60%\")\n        this.mainwidth=\"80%\"\n      else\n        this.mainwidth=\"60%\"\n    }\n  }\n}\n",null]}