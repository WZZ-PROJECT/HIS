{"remainingRequest":"D:\\IdeaProjects\\HIS\\HIS-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\IdeaProjects\\HIS\\HIS-web\\src\\views\\outpatient\\maintain\\inspection.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\IdeaProjects\\HIS\\HIS-web\\src\\views\\outpatient\\maintain\\inspection.vue","mtime":1596785876400},{"path":"D:\\IdeaProjects\\HIS\\HIS-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\IdeaProjects\\HIS\\HIS-web\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\IdeaProjects\\HIS\\HIS-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\IdeaProjects\\HIS\\HIS-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport {getNondrugModelList,updateModel,createModel,deleteModel} from '@/api/nondrugmodel'\r\nimport {getAllNondrug} from '@/api/non_drug'\r\nimport Pagination from '@/components/Pagination'\r\nimport { deepClone,parseTime } from '@/utils'\r\nexport default {\r\n    components: {Pagination},\r\n  data(){\r\n    return{\r\n      chonondruglist:[],\r\n      choices:[],\r\n      dialogVisible:false,\r\n      alldrugList:[],\r\n      nondrugList:[],\r\n      edit:0,\r\n      model:{},\r\n      loading:false,\r\n      isaside:false,\r\n      asidewidth:\"100%\",\r\n      total:0,\r\n      listQuery:{\r\n        nonDrugIdList:'',\r\n        id:'',\r\n        status:1,\r\n        name:'',\r\n        scope:0,\r\n        ownId:this.$store.getters.id,\r\n        aim:'',\r\n        code:'',\r\n        type:'',\r\n        pageSize:20,\r\n        pageNum:1,\r\n        isAdmin:'0'\r\n      },\r\n      modelList:[],\r\n      queryModel:{\r\n        name:'',\r\n        range:'',\r\n        type:''\r\n      }\r\n    }\r\n  },\r\n  created(){\r\n    this.getModelList()\r\n    this.getAllNondrug()\r\n  },\r\n  methods:{\r\n    deleteModel(row){\r\n       this.$confirm('确认删除当前模板?', '警告', {\r\n        confirmButtonText: '确认',\r\n        cancelButtonText: '取消',\r\n        type: 'warning'\r\n      }).then(()=>{      deleteModel(row.id).then(res=>{\r\n        this.getModelList()\r\n        this.$notify({\r\n          title: '成功',\r\n          message: res.message,\r\n          type: 'success',\r\n          duration: 2000\r\n        })\r\n      })})\r\n\r\n    },\r\n    createModel(){\r\n      let data = deepClone(this.model)\r\n      data.status = 1\r\n      data.ownId = this.$store.getters.id\r\n      data.nonDrugIdList = deepClone(this.choices)\r\n      data.scope = 0\r\n      createModel(data).then(res=>{\r\n        this.getModelList()\r\n        this.$notify({\r\n          title: '成功',\r\n          message: '成功创建模板',\r\n          type: 'success',\r\n          duration: 2000\r\n        })\r\n      })\r\n      this.showaside()\r\n    },\r\n    updateModel(){\r\n      let data = deepClone(this.model)\r\n      data.nonDrugIdList = deepClone(this.choices)\r\n      updateModel(data).then(res=>{\r\n        this.getModelList()\r\n        this.$notify({\r\n          title: '成功',\r\n          message: res.message,\r\n          type: 'success',\r\n          duration: 2000\r\n        })\r\n      })\r\n      this.showaside()\r\n    },\r\n    confirmItem(){\r\n      this.nondrugList = this.alldrugList.filter(item=>{\r\n        if(this.choices.includes(item.id))\r\n          return true\r\n      })\r\n      this.dialogVisible=!this.dialogVisible\r\n    },\r\n    addItem(){\r\n      if(this.model.type===0||this.model.type===1||this.model.type===2){\r\n        this.chonondruglist = this.alldrugList.filter(item=>{\r\n          if(item.recordType===this.model.type+1)\r\n            return true\r\n          return false\r\n        })\r\n        this.dialogVisible = true\r\n        return\r\n      }\r\n      this.getModelList()\r\n        this.$notify({\r\n          title: '警告',\r\n          message: '请先选择类型！',\r\n          type: 'warning',\r\n          duration: 2000\r\n        })\r\n    },\r\n    getAllNondrug(){\r\n      getAllNondrug().then(res=>{\r\n        this.alldrugList = res.data\r\n        this.alldrugList.forEach(item=>{\r\n          item.label = item.name\r\n          item.key = item.id\r\n        })\r\n      })\r\n    },\r\n    async getModelList(){\r\n      getNondrugModelList(this.listQuery).then(res=>{\r\n        this.modelList = res.data.list\r\n        this.total = res.data.total\r\n      })\r\n      \r\n    },\r\n    searchModel(){\r\n      this.loading = true\r\n      this.getModelList()\r\n      this.loading = false\r\n    },\r\n    showaside(type){\r\n      if(this.asidewidth===\"100%\")\r\n        this.asidewidth=\"0%\"\r\n      else\r\n        this.asidewidth=\"100%\"\r\n      this.isaside=!this.isaside\r\n      if(type==='edit')\r\n        this.edit = 1\r\n      else if(type==='add'){\r\n        this.choices = []\r\n        this.nondrugList = []\r\n        this.model = {}\r\n        this.edit = 0 \r\n      }\r\n      else\r\n        this.edit = 0\r\n    },\r\n    editModel(row){\r\n      this.choices = deepClone(row.nonDrugIdList)\r\n      this.nondrugList = this.alldrugList.filter(item=>{\r\n        if(row.nonDrugIdList.includes(item.id))\r\n          return true\r\n      })\r\n      this.model = deepClone(row)\r\n      this.model.createTime = parseTime(this.model.createTime)\r\n      this.showaside('edit')\r\n    }\r\n  }\r\n}\r\n",null]}