{"remainingRequest":"D:\\IdeaProjects\\HIS\\HIS-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\IdeaProjects\\HIS\\HIS-web\\src\\views\\outpatient\\workstation\\confirm.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\IdeaProjects\\HIS\\HIS-web\\src\\views\\outpatient\\workstation\\confirm.vue","mtime":1596785876402},{"path":"D:\\IdeaProjects\\HIS\\HIS-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\IdeaProjects\\HIS\\HIS-web\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\IdeaProjects\\HIS\\HIS-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\IdeaProjects\\HIS\\HIS-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n  \r\nimport {getnonend,submitdefinite} from '@/api/outpatient/dmscase'\r\nimport {getDmsDislist,parseList} from '@/api/diagnosis'\r\nimport Pagination from '@/components/Pagination'\r\nimport {selectByType} from '@/api/outpatient/frequentuse'\r\nimport {parseTime} from '@/utils'\r\nexport default {\r\n  props:['patient'],\r\n  components: {Pagination},\r\n  name:'Comfirm',\r\n  data(){\r\n    return{\r\n      medicineDiseIdList:[],\r\n      dialogTableVisible:false,\r\n      total:0,\r\n      record:[],\r\n      disQuery: {\r\n        catId: '',\r\n        code: '',\r\n        name: '',\r\n        icd: '',\r\n        status: '',\r\n        pageSize: 8,\r\n        pageNum: 1\r\n      },\r\n      disList:[],\r\n      prerecord:{},\r\n      activeName:'first',\r\n      isclose:true,\r\n      mainwidth:\"60%\",\r\n      activeNames: ['1'],\r\n      data2:[\r\n        {\r\n          date: '0001',\r\n          name: '王小虎1',\r\n          address: '38岁'\r\n        },\r\n        {\r\n          date: '0002',\r\n          name: '王小虎2',\r\n          address: '39岁'\r\n        }\r\n      ]\r\n    };\r\n  },\r\n  created(){\r\n    this.getmedicineDiseIdList()\r\n  },\r\n  watch:{\r\n    'patient' : function(newVal, oldVal){\r\n      this.patient = newVal\r\n      this.getnonend()\r\n    },\r\n  },\r\n  methods:{\r\n    getmedicineDiseIdList(){\r\n      selectByType({staffId:this.$store.getters.id,selectType:2}).then(res=>{\r\n        this.medicineDiseIdList = res.data.medicineDiseList\r\n      })\r\n    },\r\n    submitdefinite(){\r\n      this.prerecord.definiteDiseStrList = ''\r\n      this.record.forEach(item=>{\r\n        this.prerecord.definiteDiseStrList += (item.id+',')\r\n      })\r\n      this.prerecord.startDate = parseTime(this.prerecord.startDate).substr(0,10)\r\n      this.prerecord.createTime = parseTime(this.prerecord.createTime).substr(0,10)\r\n      this.prerecord.definiteDiseStrList = this.prerecord.definiteDiseStrList.substr(0, this.prerecord.definiteDiseStrList.length - 1);\r\n      submitdefinite(this.prerecord).then(res=>{\r\n          this.$notify({\r\n          title: '成功',\r\n          message: '已确诊!',\r\n          type: 'success',\r\n          duration: 2000\r\n        })\r\n        this.$emit('comfirmdms')\r\n        \r\n      })\r\n    },\r\n    deleteDis(row){\r\n      this.record=this.record.filter(item=>{\r\n        if(item.id===row.id)\r\n          return false\r\n        return true\r\n      })\r\n    },\r\n    selectDis(val){\r\n      this.$confirm('是否添加 '+val.name+' 到该患者?', '添加诊断', {\r\n          confirmButtonText: '确认',\r\n          cancelButtonText: '取消',\r\n          type: 'success'\r\n        }).then(()=>{\r\n          let flag = 1\r\n          this.record.forEach(item=>{\r\n            if(item.icd===val.icd){\r\n              flag=0\r\n            }\r\n          })\r\n          if(flag)\r\n            this.record.push(val)\r\n          else\r\n            alert('已存在该诊断！')\r\n          this.dialogTableVisible = false\r\n        })\r\n    },\r\n    addDis(){\r\n      this.dialogTableVisible=true\r\n      this.getDis()\r\n    },\r\n    async getDis(){\r\n      const res = await getDmsDislist(this.disQuery)\r\n      this.disList = res.data.list\r\n      this.total = res.data.total\r\n    },\r\n    getnonend(){\r\n      getnonend(this.patient.registrationId).then(res=>{\r\n        this.prerecord = res.data.dmsCaseHistoryList[0]\r\n        parseList(this.prerecord.priliminaryDiseIdList).then(res=>{\r\n          this.record = res.data\r\n        })\r\n      })\r\n    },\r\n    controlfast(){\r\n      this.isclose=!this.isclose\r\n      if(this.mainwidth===\"60%\")\r\n        this.mainwidth=\"80%\"\r\n      else\r\n        this.mainwidth=\"60%\"\r\n    }\r\n  }\r\n}\r\n",null]}