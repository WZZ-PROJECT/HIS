{"remainingRequest":"F:\\XM\\his-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\XM\\his-web\\src\\views\\registWork\\dayReport.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\XM\\his-web\\src\\views\\registWork\\dayReport.vue","mtime":1600936446225},{"path":"F:\\XM\\his-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1600936410370},{"path":"F:\\XM\\his-web\\node_modules\\babel-loader\\lib\\index.js","mtime":1600936408645},{"path":"F:\\XM\\his-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1600936410370},{"path":"F:\\XM\\his-web\\node_modules\\vue-loader\\lib\\index.js","mtime":1600936442292}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\r\nimport {parseTime,formatTime} from '@/utils'\r\nimport {queryRecentEndDatetime,queryInvoiceInfo,dailySettle,querySettleDetailById} from '@/api/dayreport'\r\nimport { selectAll } from '@/api/signature'\r\nimport { parse } from 'path';\r\nexport default {\r\n  data(){\r\n    return{\r\n      hide:true,\r\n      printtable:false,\r\n      rijiedan:false,\r\n      reportdetail:[],\r\n      InvoiceInfoList:[],\r\n      starttime:'',\r\n      endtime:'',\r\n      activeName:'first',\r\n       pickerOptions: {\r\n          disabledDate(time) {\r\n            return time.getTime() > Date.now();\r\n          }\r\n      },\r\n      test:[\r\n        {\r\n          id:111,\r\n          name:222,\r\n        },\r\n        {\r\n          id:111,\r\n          name:222,\r\n        },\r\n        {\r\n          id:111,\r\n          name:222,\r\n        },\r\n        {\r\n          id:111,\r\n          name:222,\r\n        },\r\n      ]\r\n    };\r\n  },\r\n  created(){\r\n    this.handleSubmit();\r\n    queryRecentEndDatetime(this.$store.getters.id).then(res=>{\r\n      this.starttime = parseTime(res.data)\r\n    })\r\n  },\r\n  methods:{\r\n    print(e){\r\n      const subOutputRankPrint = document.getElementById('table')\r\n      const newContent = subOutputRankPrint.innerHTML\r\n      const oldContent = document.body.innerHTML\r\n      document.body.innerHTML = newContent\r\n      window.print()\r\n      window.location.reload()\r\n      document.body.innerHTML = oldContent\r\n      return false\r\n    },\r\n    querySettleDetailById(data){\r\n      querySettleDetailById(data).then(res=>{\r\n        this.reportdetail = res.data\r\n        this.reportdetail.startDatetime = parseTime(this.reportdetail.startDatetime)\r\n        this.reportdetail.endDatetime = parseTime(this.reportdetail.endDatetime)\r\n        this.reportdetail.createDatetime = parseTime(this.reportdetail.createDatetime)\r\n      })\r\n    },\r\n    queryInvoiceInfo(){\r\n      let data = {}\r\n      data.cashierId = this.$store.getters.id\r\n      data.startDatetime = parseTime(this.starttime)\r\n      data.endDatetime = parseTime(this.endtime)\r\n      queryInvoiceInfo(data).then(res=>{\r\n        this.InvoiceInfoList = res.data\r\n        this.InvoiceInfoList.forEach(item=>{\r\n          item.createTime = parseTime(item.createTime)\r\n        })\r\n      })\r\n    },\r\n    dailySettle(){\r\n      let data = {}\r\n      data.cashierId =this.$store.getters.id\r\n      data.startDatetime = parseTime(this.starttime)\r\n      data.endDatetime = parseTime(this.endtime)\r\n      dailySettle(data).then(res=>{\r\n        this.$notify({\r\n          title: '成功',\r\n          message: '已生成日结单',\r\n          type: 'success',\r\n          duration: 2000\r\n        })\r\n\r\n        this.rijiedan = true\r\n        this.querySettleDetailById(res.data)\r\n        this.printtable = true\r\n        this.handleSubmit();\r\n        this.hide = false;\r\n      })\r\n\r\n    },\r\n    handleSubmit() {\r\n      selectAll().then(res=>{\r\n        console.log(res)\r\n        this.$refs.sign.getStar(res.data.typeName,res.data.name,res.data.code)\r\n        this.img = this.$refs.sign.submit(80, 50);\r\n        console.log(this.img)\r\n      })\r\n\r\n    }\r\n  }\r\n}\r\n",null]}